<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Registro</title>
    <link rel="stylesheet" href="style/register_styles.css" media="screen" title="no title">
    <link rel="stylesheet" href="images/font-awesome/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">
</head>
<body>
<div class="titulo">
    <img id="logo" src="images/logo.png" alt="logo">
    <h1>I Like It!</h1>
</div>
<hr>
<h2>Regístrate para poder compartir las fotos de tus mejores platos</h2>
<h3>Completa el siguiente formulario con tus datos</h3>
<form onsubmit="return(validateAll())" action="index.html">
    <fieldset>
        <legend>Dirección de registro</legend>
        <div class="flex">
            <input class="entrada" id="nombre" name="name" type="text" placeholder="Nombre" style="margin-right: 1%"
                   required>
            <input class="entrada" id="apellido" name="surname" type="text" placeholder="Apellidos" required>
        </div>
        <div>
            <input class="entrada" id="mail1"
                   pattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?"
                   name="email" onkeyup="mailMatch()" type="email" placeholder="Correo electrónico" required>
            <input class="entrada" id="mail2"
                   pattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?"
                   name="confirmEmail" onkeyup="mailMatch()" type="email"
                   placeholder="Confirmación de correo electrónico" required>
        </div>
    </fieldset>
    <fieldset>
        <legend>Información de usuario</legend>
        <input class="entrada" id="username" name="username" type="text" placeholder="Usuario" required><br>
        <div class="flex">
            <!--TODO Revisar gramatica regular-->
            <input class="entrada" id="pass1" onkeyup="passMatch()" name="password" type="password"
                   placeholder="Contraseña" maxlength="8" pattern="(?=.*\d)(?=.*[a-z])(?=.*[0-9]).{,8}"
                   title="Letras minúsculas y números" style="margin-right: 1%" required>
            <input class="entrada" id="pass2" onkeyup="passMatch()" name="confirmPassword" type="password"
                   placeholder="Confirmar contraseña" maxlength="8" pattern="(?=.*\d)(?=.*[a-z])(?=.*[0-9]).{,8}"
                   title="Letras minúsculas y números" required>
        </div>
        <small>La contraseña sólo puede contener letras minúsculas y números.</small>
        <div id="profile-picture">
            Haz click en la foto de perfil para cambiarla: <br>
            <input id="files" name="profilePicture" type="file" accept="image/*" formenctype="multipart/form-data"
                   formmethod="post">
            <label for="files"><img id="preview" src="images/unknown_user.jpg"></label>
            <small>La foto de perfil podrá ser cambiada en cualquier momento desde el apartado Opciones de la cuenta.
            </small>
        </div>
    </fieldset>
    <fieldset>
        <legend>Información de intereses y hobbies</legend>
        <div id="intereses">
            <input type="checkbox" name="intereses" value="1">Arte
            <input type="checkbox" name="intereses" value="2">Coches
            <input type="checkbox" name="intereses" value="3">Cocina
            <input type="checkbox" name="intereses" value="4">Manualidades
            <input type="checkbox" name="intereses" value="5">Citas
            <input type="checkbox" name="intereses" value="6">Juego
            <input type="checkbox" name="intereses" value="7">Música
            <input type="checkbox" name="intereses" value="8">Animales
            <input type="checkbox" name="intereses" value="9">Política
            <input type="checkbox" name="intereses" value="10">Lectura
            <input type="checkbox" name="intereses" value="11">Deporte
            <input type="checkbox" name="intereses" value="12">Televisión
            <input type="checkbox" name="intereses" value="13">Industria
            <input type="checkbox" name="intereses" value="14">Tecnología
            <input type="checkbox" name="intereses" value="15">Sorteos
            <input type="checkbox" name="intereses" value="16">Antigüedad
        </div>
        ¿Eres aficionado a la fotografía?
        <input name="fotografia" type="radio" value="0" checked>No
        <input name="fotografia" type="radio" value="1">Si

        <div id="aficionado">
            <input class="entrada" name="estudio" type="text" placeholder="Estudio fotográfico">
            <input class="entrada" name="direccionEstudio" type="text" placeholder="Dirección del estudio">
            <input class="entrada" pattern="[0-9]{1,9}" name="tel" type="tel" placeholder="Teléfono">
        </div>
        <div><input id="condiciones" type="checkbox" required>He leído y acepto las condiciones de uso.</div>
        <div id="submit">
            <input type="submit" value="Registrarse">
        </div>
    </fieldset>
</form>
<script>

    function sendMail(dmail) {
        // TODO Poner parametros al correo
        window.open('mailto:' + dmail);
    }

    var validReg = true;
    function validateAll() {
        if (document.getElementById('nombre').value == "") {
            document.getElementById('nombre').style.backgroundColor = "#ff6666";
            validReg = false;
        }
        if (document.getElementById('apellido').value == "") {
            document.getElementById('apellido').style.backgroundColor = "#ff6666";
            validReg = false;
        }
        if (document.getElementById('mail1').value == "" || mailMatch() == false) {
            document.getElementById('mail1').style.backgroundColor = "#ff6666";
            document.getElementById('mail2').style.backgroundColor = "#ff6666";
            validReg = false;
        } else {
            var cmail = document.getElementById('mail1').value;
        }
        if (document.getElementById('username').value == "") {
            document.getElementById('username').style.backgroundColor = "#ff6666";
            validReg = false;
        }
        if (document.getElementById('pass1').value == "" || passMatch() == false) {
            document.getElementById('pass1').style.backgroundColor = "#ff6666";
            document.getElementById('pass2').style.backgroundColor = "#ff6666";
            validReg = false;
        }
        if (validReg == true) {
            sendMail(cmail);
            alert("Operación realizada con éxito");
        }
        return validReg;
    }

    var radios = document.getElementsByName('fotografia');
    for (var i = 0; i < radios.length; i++) {
        radios[i].addEventListener('click', toggleAficionado, false);
    }

    function toggleAficionado() {
        var aficionado = document.getElementById("aficionado");
        if (this.value == 1) {
            aficionado.style.display = "block";
            window.scrollTo(0, document.body.scrollHeight);
            aficionado.children[0].required = true;
            aficionado.children[1].required = true;
        } else {
            aficionado.style.display = "none";
            aficionado.children[0].required = false;
            aficionado.children[1].required = false;
        }
    }

    function passMatch() {
        var pass1 = document.getElementById('pass1').value;
        var pass2 = document.getElementById('pass2').value;
        if (pass1 != pass2) {
            //document.getElementById("pass1").style.backgroundColor = "#ff6666";
            document.getElementById("pass2").style.backgroundColor = "#ff6666";
            var passValid = false;
        } else {
            //document.getElementById("pass1").style.backgroundColor = "#66cc66";
            //document.getElementById("pass2").style.backgroundColor = "#66cc66";
        }
        return passValid;
    }

    function mailMatch() {
        var mail1 = document.getElementById("mail1").value;
        var mail2 = document.getElementById("mail2").value;
        if (mail1 != mail2) {
            document.getElementById("mail2").style.backgroundColor = "#ff6666";
            var mailValid = false;
        } else {
            //document.getElementById("mail2").style.backgroundColor = "#66cc66";
        }
        return mailValid;
    }

    document.getElementById("files").onchange = function () {
        var reader = new FileReader();
        reader.onload = function (e) {
            document.getElementById("preview").src = e.target.result;
            document.getElementById("preview").style.display = "block";
        };
        reader.readAsDataURL(this.files[0]);
    };

</script>
</body>
</html>